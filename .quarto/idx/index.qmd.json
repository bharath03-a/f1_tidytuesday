{"title":"F1 Analysis","markdown":{"yaml":{"title":"F1 Analysis","author":"Bharath Velamala","description":"Data Visualization using R on tidyTuesday dataset","format":{"html":{"code-tools":true,"code-link":true}},"toc":true,"code-annotations":"hover","categories":["R","DataViz","TidyTuesday"]},"headingText":"Formula 1 Races","containsRefs":false,"markdown":"\n\n\nThe data this week comes from the [Ergast API](https://ergast.com/mrd/db/#csv), which has a CC-BY license. H/t to [Sara Stoudt](https://github.com/rfordatascience/tidytuesday/issues/372) for sharing the link to the data by way of [Data is Plural](https://www.data-is-plural.com/archive/2021-08-25-edition/)!\n\n[FiveThirtyEight](https://fivethirtyeight.com/features/formula-one-racing/) published a nice article on \"Who's The Best Formula One Driver Of All Time?\". While the ELO data is not present in this dataset, you could calculate your own rating or using the [`{elo}`](https://github.com/eheinzen/elo) package to create ELO scores.\n\n## Set up\n\n```{r load_libraries, warning=FALSE, message=FALSE, output=FALSE}\n#| code-fold: true\n\n### GETTING THE LIBRARIES\nif (!require(pacman)) #<1>\n  install.packages(pacman)\n\n\npacman::p_load(tidyverse,\n               openintro,\n               gridExtra,\n               tidytuesdayR,\n               dplyr,\n               dlookr,\n               DMwR2,  # Data Mining with R functions\n               GGally, # Pair-wise plots using ggplot2\n               Hmisc,  # Data analysis\n               formattable)   #<2>\n```\n\n1.  This block is to check if `pacman` package is installed or not, if it isn't then the package will be installed.\n\n2.  `p_load` is a function from `pacman` package to load other packages, if isn't installed `pacman` will handle the installation.\n\nSetting the default theme ggplot and output options for the chunk - as suggested in the class.\n\n```{r set_theme, warning=FALSE, message=FALSE}\n#| code-fold: true\n\n### setting theme for ggplot2\nggplot2::theme_set(ggplot2::theme_minimal(base_size = 14, base_family = \"sans\"))\n\n\n# setting width of code output\noptions(width = 65)\n\n# setting figure parameters for knitr\nknitr::opts_chunk$set(\n  fig.width = 8,        # 8\" width\n  fig.asp = 0.618,      # the golden ratio\n  fig.retina = 4,       # dpi multiplier for displaying HTML output on retina\n  fig.align = \"center\", # center align figures\n  dpi = 350             # higher dpi, sharper image\n)\n```\n\n## Getting Data\n\n```{r f1_data, warning=FALSE, message=FALSE}\ntuesdata <- tidytuesdayR::tt_load('2021-09-07')\n\nresults <- tuesdata$results\ndriver_standings <- tuesdata$driver_standings\nraces <- tuesdata$races\ndrivers <- tuesdata$drivers\n```\n\n```{r driver_results, warning=FALSE, message=FALSE}\ndriver_results_df <- driver_standings |>\n  left_join(races, by = \"raceId\") |>\n  rename(driver_url = url) |>\n  left_join(drivers, by = \"driverId\") |> filter( year >= 2020)\n\nmissing_count <- colSums(is.na(driver_results_df))\n\nmissing_count\n```\n\n## Questions\n\n#### Who's the youngest F1 driver with the most wins? Who's the oldest F1 driver in the history of the sport? And who's everyone in between?\n\n::: callout-note\nGetting only data after 2017 for relevancy!\n:::\n\nAs of now the unknowns are age of the drivers, and their position in the races. We need to two new columns to cater that data.\n\n```{r f1_functions, warning=FALSE, message=FALSE}\ncalculateAge <- function(dob) {\n  # Convert DOB to Date class\n  dob <- as.Date(dob)\n  \n  # Calculate age\n  age <- as.integer(difftime(Sys.Date(), dob, units = \"days\") / 365)\n  \n  return(age)\n}\n\ngetRacePos <- function(position) {\n  case_when(\n    position == 1 ~ \"WINNER\",\n    (position > 1 & position <=3) ~ \"PODIUM\",\n    (position > 3 & position <=10) ~ \"TOP10\",\n    TRUE ~ \"Other\"  # Default case when none of the above conditions are met\n  )\n}\n```\n\n```{r data_preprocessing, warning=FALSE, message=FALSE}\ndriver_results_df <- driver_results_df |> mutate(\n  drivers_age = calculateAge(driver_results_df$dob),\n  race_pos = getRacePos(driver_results_df$position)\n)\n```\n\n```{r initial_plot, warning=FALSE, message=FALSE, fig.height=10}\nggplot(driver_results_df, mapping = aes(x = code, y = drivers_age)) +\n  geom_point(aes(color = race_pos, size=3), stat='identity') + \n  coord_flip()\n```\n","srcMarkdownNoYaml":"\n\n# Formula 1 Races\n\nThe data this week comes from the [Ergast API](https://ergast.com/mrd/db/#csv), which has a CC-BY license. H/t to [Sara Stoudt](https://github.com/rfordatascience/tidytuesday/issues/372) for sharing the link to the data by way of [Data is Plural](https://www.data-is-plural.com/archive/2021-08-25-edition/)!\n\n[FiveThirtyEight](https://fivethirtyeight.com/features/formula-one-racing/) published a nice article on \"Who's The Best Formula One Driver Of All Time?\". While the ELO data is not present in this dataset, you could calculate your own rating or using the [`{elo}`](https://github.com/eheinzen/elo) package to create ELO scores.\n\n## Set up\n\n```{r load_libraries, warning=FALSE, message=FALSE, output=FALSE}\n#| code-fold: true\n\n### GETTING THE LIBRARIES\nif (!require(pacman)) #<1>\n  install.packages(pacman)\n\n\npacman::p_load(tidyverse,\n               openintro,\n               gridExtra,\n               tidytuesdayR,\n               dplyr,\n               dlookr,\n               DMwR2,  # Data Mining with R functions\n               GGally, # Pair-wise plots using ggplot2\n               Hmisc,  # Data analysis\n               formattable)   #<2>\n```\n\n1.  This block is to check if `pacman` package is installed or not, if it isn't then the package will be installed.\n\n2.  `p_load` is a function from `pacman` package to load other packages, if isn't installed `pacman` will handle the installation.\n\nSetting the default theme ggplot and output options for the chunk - as suggested in the class.\n\n```{r set_theme, warning=FALSE, message=FALSE}\n#| code-fold: true\n\n### setting theme for ggplot2\nggplot2::theme_set(ggplot2::theme_minimal(base_size = 14, base_family = \"sans\"))\n\n\n# setting width of code output\noptions(width = 65)\n\n# setting figure parameters for knitr\nknitr::opts_chunk$set(\n  fig.width = 8,        # 8\" width\n  fig.asp = 0.618,      # the golden ratio\n  fig.retina = 4,       # dpi multiplier for displaying HTML output on retina\n  fig.align = \"center\", # center align figures\n  dpi = 350             # higher dpi, sharper image\n)\n```\n\n## Getting Data\n\n```{r f1_data, warning=FALSE, message=FALSE}\ntuesdata <- tidytuesdayR::tt_load('2021-09-07')\n\nresults <- tuesdata$results\ndriver_standings <- tuesdata$driver_standings\nraces <- tuesdata$races\ndrivers <- tuesdata$drivers\n```\n\n```{r driver_results, warning=FALSE, message=FALSE}\ndriver_results_df <- driver_standings |>\n  left_join(races, by = \"raceId\") |>\n  rename(driver_url = url) |>\n  left_join(drivers, by = \"driverId\") |> filter( year >= 2020)\n\nmissing_count <- colSums(is.na(driver_results_df))\n\nmissing_count\n```\n\n## Questions\n\n#### Who's the youngest F1 driver with the most wins? Who's the oldest F1 driver in the history of the sport? And who's everyone in between?\n\n::: callout-note\nGetting only data after 2017 for relevancy!\n:::\n\nAs of now the unknowns are age of the drivers, and their position in the races. We need to two new columns to cater that data.\n\n```{r f1_functions, warning=FALSE, message=FALSE}\ncalculateAge <- function(dob) {\n  # Convert DOB to Date class\n  dob <- as.Date(dob)\n  \n  # Calculate age\n  age <- as.integer(difftime(Sys.Date(), dob, units = \"days\") / 365)\n  \n  return(age)\n}\n\ngetRacePos <- function(position) {\n  case_when(\n    position == 1 ~ \"WINNER\",\n    (position > 1 & position <=3) ~ \"PODIUM\",\n    (position > 3 & position <=10) ~ \"TOP10\",\n    TRUE ~ \"Other\"  # Default case when none of the above conditions are met\n  )\n}\n```\n\n```{r data_preprocessing, warning=FALSE, message=FALSE}\ndriver_results_df <- driver_results_df |> mutate(\n  drivers_age = calculateAge(driver_results_df$dob),\n  race_pos = getRacePos(driver_results_df$position)\n)\n```\n\n```{r initial_plot, warning=FALSE, message=FALSE, fig.height=10}\nggplot(driver_results_df, mapping = aes(x = code, y = drivers_age)) +\n  geom_point(aes(color = race_pos, size=3), stat='identity') + \n  coord_flip()\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":true,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","editor":"visual","theme":"lux","title":"F1 Analysis","author":"Bharath Velamala","description":"Data Visualization using R on tidyTuesday dataset","code-annotations":"hover","categories":["R","DataViz","TidyTuesday"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}